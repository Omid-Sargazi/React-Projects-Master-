<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <style>
        body { font-family: sans-serif; padding: 20px; }
        .counter { 
            border: 2px solid #333; 
            padding: 20px; 
            margin: 20px; 
            border-radius: 10px;
            display: inline-block;
        }
        button { 
            margin: 5px; 
            padding: 10px 15px;
            font-size: 16px;
            cursor: pointer;
        }
        .info {
            background: #f0f0f0;
            padding: 10px;
            margin-top: 10px;
            border-radius: 5px;
        }
    </style>
</head>
<body>
        <h1>ğŸ¯ Ù‚Ø¯Ù… Ø¨Ø¹Ø¯ÛŒ: Component State</h1>
    <p>Ø­Ø§Ù„Ø§ Ù‡Ø± counter state Ø®ÙˆØ¯Ø´ Ø±Ø§ Ø¯Ø§Ø±Ø¯!</p>
    
    <div id="app1"></div>
    <div id="app2"></div>
    
    <div class="info">
        <h3>Ù„Ø§Ú¯ Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§:</h3>
        <div id="logs"></div>
    </div>

    <script>
        // ğŸ“Š Ø³ÛŒØ³ØªÙ… Ù„Ø§Ú¯ Ø¨Ø±Ø§ÛŒ Ø¯ÛŒØ¯Ù† Ø§ØªÙØ§Ù‚â€ŒÙ‡Ø§
        function log(message) {
            const logs = document.getElementById('logs');
            const time = new Date().toLocaleTimeString();
            logs.innerHTML = `<div><strong>${time}:</strong> ${message}</div>` + logs.innerHTML;
        }

        // ğŸ—ï¸ Ø³Ø§Ø®ØªØ§Ø± Ø¬Ø¯ÛŒØ¯: Ù‡Ø± component Ù†Ù…ÙˆÙ†Ù‡ Ø®ÙˆØ¯Ø´ Ø±Ø§ Ø¯Ø§Ø±Ø¯
        function createCounter(initialValue = 0, containerId) {
            log(`Ø³Ø§Ø®Øª counter Ø¬Ø¯ÛŒØ¯ Ø¨Ø§ Ù…Ù‚Ø¯Ø§Ø± ${initialValue} Ø¯Ø± ${containerId}`);
            
            // ğŸ”’ state Ø®ØµÙˆØµÛŒ Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ† component
            let state = {
                count: initialValue,
                id: Math.random().toString(36).substr(2, 9) // ÛŒÚ© ID Ù…Ù†Ø­ØµØ± Ø¨Ù‡ ÙØ±Ø¯
            };
            
            // ğŸ¨ ØªØ§Ø¨Ø¹ render Ø§ÛŒÙ† component
            function render() {
                log(`ğŸ”µ Render counter ${state.id} Ø¨Ø§ count=${state.count}`);
                
                const color = state.count > 0 ? "green" : state.count < 0 ? "red" : "#666";
                
                return `
                    <div class="counter">
                        <h2>Counter ${state.id.substr(0, 5)}</h2>
                        <h1 style="color: ${color}; font-size: 48px;">
                            ${state.count}
                        </h1>
                        <button class="inc">â• Ø§ÙØ²Ø§ÛŒØ´</button>
                        <button class="dec">â– Ú©Ø§Ù‡Ø´</button>
                        <button class="reset">ğŸ”„ ØµÙØ± Ú©Ù†</button>
                        <p>ID: ${state.id}</p>
                    </div>
                `;
            }
            
            // ğŸ¯ setState Ù…Ø®ØµÙˆØµ Ø§ÛŒÙ† component
            function setState(newState) {
                log(`ğŸŸ¡ setState Ø¨Ø±Ø§ÛŒ counter ${state.id}: ${JSON.stringify(state)} â†’ ${JSON.stringify(newState)}`);
                
                // Ø¢Ù¾Ø¯ÛŒØª state
                state = { ...state, ...newState };
                
                // Ø±Ù†Ø¯Ø± component Ø¯Ø± container Ù…Ø®ØµÙˆØµØ´
                const container = document.getElementById(containerId);
                container.innerHTML = render();
                
                // ÙˆØµÙ„ Ú©Ø±Ø¯Ù† eventÙ‡Ø§ Ø¨Ø¹Ø¯ Ø§Ø² Ø±Ù†Ø¯Ø±
                bindEvents(containerId);
            }
            
            // ğŸ® ÙˆØµÙ„ Ú©Ø±Ø¯Ù† eventÙ‡Ø§
            function bindEvents(containerId) {
                const container = document.getElementById(containerId);
                
                container.querySelector('.inc').onclick = () => {
                    log(`Ø¯Ú©Ù…Ù‡ â• Ø¯Ø± counter ${state.id} Ú©Ù„ÛŒÚ© Ø´Ø¯`);
                    setState({ count: state.count + 1 });
                };
                
                container.querySelector('.dec').onclick = () => {
                    log(`Ø¯Ú©Ù…Ù‡ â– Ø¯Ø± counter ${state.id} Ú©Ù„ÛŒÚ© Ø´Ø¯`);
                    setState({ count: state.count - 1 });
                };
                
                container.querySelector('.reset').onclick = () => {
                    log(`Ø¯Ú©Ù…Ù‡ ğŸ”„ Ø¯Ø± counter ${state.id} Ú©Ù„ÛŒÚ© Ø´Ø¯`);
                    setState({ count: 0 });
                };
            }
            
            // ğŸš€ Ø§ÙˆÙ„ÛŒÙ† Ø±Ù†Ø¯Ø±
            const container = document.getElementById(containerId);
            container.innerHTML = render();
            bindEvents(containerId);
            
            // ğŸ”§ Ø¨Ø±Ú¯Ø±Ø¯Ø§Ù†Ø¯Ù† API Ø¹Ù…ÙˆÙ…ÛŒ Ø§ÛŒÙ† component
            return {
                getState: () => ({ ...state }), // Ú©Ù¾ÛŒ Ø§Ø² state Ø¨Ø±Ø§ÛŒ Ù…Ø­Ø§ÙØ¸Øª
                setState: setState,
                getId: () => state.id
            };
        }
        
        log("ğŸš€ Ø´Ø±ÙˆØ¹ Ø¨Ø±Ù†Ø§Ù…Ù‡...");
        
        // Ø³Ø§Ø®Øª Ø¯Ùˆ counter Ú©Ø§Ù…Ù„Ø§Ù‹ Ù…Ø³ØªÙ‚Ù„
        const counter1 = createCounter(10, 'app1');
        const counter2 = createCounter(-5, 'app2');
        
        // ğŸ’¡ ØªØ³Øª: Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒÙ… Ø§Ø² Ø¨ÛŒØ±ÙˆÙ† Ù‡Ù… state Ø±Ø§ Ø¹ÙˆØ¶ Ú©Ù†ÛŒÙ…
        setTimeout(() => {
            log("â° ØªØ§ÛŒÙ…Ø±: Ø¨Ø¹Ø¯ Ø§Ø² 3 Ø«Ø§Ù†ÛŒÙ‡ØŒ counter Ø§ÙˆÙ„ Ø±Ø§ 5+ Ù…ÛŒâ€ŒÚ©Ù†Ù…");
            counter1.setState({ count: counter1.getState().count + 5 });
        }, 3000);
        
        setTimeout(() => {
            log("â° ØªØ§ÛŒÙ…Ø±: Ø¨Ø¹Ø¯ Ø§Ø² 5 Ø«Ø§Ù†ÛŒÙ‡ØŒ counter Ø¯ÙˆÙ… Ø±Ø§ 10- Ù…ÛŒâ€ŒÚ©Ù†Ù…");
            counter2.setState({ count: counter2.getState().count - 10 });
        }, 5000);
        
        // ğŸª Ø¯Ú©Ù…Ù‡ Ø¨Ø±Ø§ÛŒ ØªØ³Øª Ø¹Ù…Ù„ÛŒØ§Øª group
        document.body.innerHTML += `
            <div style="margin-top: 30px; padding: 20px; background: #e3f2fd; border-radius: 10px;">
                <h3>ğŸª Ø¹Ù…Ù„ÛŒØ§Øª Ú¯Ø±ÙˆÙ‡ÛŒ</h3>
                <button id="resetAll">ğŸ”„ ØµÙØ± Ú©Ø±Ø¯Ù† Ù‡Ù…Ù‡ counters</button>
                <button id="addToAll">â• +2 Ø¨Ù‡ Ù‡Ù…Ù‡ counters</button>
            </div>
        `;
        
        // Ù†Ú¯Ù‡Ø¯Ø§Ø±ÛŒ reference Ø¨Ù‡ Ù‡Ù…Ù‡ counters
        const counters = [counter1, counter2];
        
        document.getElementById('resetAll').onclick = () => {
            log("ğŸ”„ Ø¹Ù…Ù„ÛŒØ§Øª Ú¯Ø±ÙˆÙ‡ÛŒ: ØµÙØ± Ú©Ø±Ø¯Ù† Ù‡Ù…Ù‡ counters");
            counters.forEach(counter => {
                counter.setState({ count: 0 });
            });
        };
        
        document.getElementById('addToAll').onclick = () => {
            log("â• Ø¹Ù…Ù„ÛŒØ§Øª Ú¯Ø±ÙˆÙ‡ÛŒ: +2 Ø¨Ù‡ Ù‡Ù…Ù‡ counters");
            counters.forEach(counter => {
                const current = counter.getState().count;
                counter.setState({ count: current + 2 });
            });
        };
    
    </script>
</body>
</html>